---
title: "Management frequency and extinction risk"
author: A. Bradley Duthie&#xb9;&#xb3;, Jeremy J. Cusack&#xb9;, Isabel L. Jones&#xb9;,
  Jeroen Minderman&#xb9;, Erlend B. Nilsen&#xb2;, Roc&#0237;o A. Pozo&#xb9;, O. Sarobidy
  Rakotonarivo&#xb9;, Bram Van Moorter&#xb2;, and Nils Bunnefeld&#xb9;
date: '[1] Biological and Environmental Sciences, University of Stirling, Stirling,
  UK [2] Norwegian Institute for Nature Research, Trondheim, Norway [3] alexander.duthie@stir.ac.uk'
output:
  pdf_document:
    citation_package: natbib
    fig_caption: yes
  html_document: default
  word_document:
    fig_caption: yes
    reference_docx: docx_template.docx
header-includes: null
linestretch: 1
link-citations: yes
linkcolor: blue
bibliography: gmse.bib
subtitle: 'GMSE: an R package for generalised management strategy evaluation (Supporting
  Information 5)'
biblio-style: apalike
---

```{r, echo = FALSE}
library(GMSE);
```

The individual-based approach of default GMSE submodels
================================================================================

The default submodels of GMSE (`resource`, `observation`, `manager`, `user`) are individual-based (also called 'agent-based'), meaning that they model discrete individuals (resources or agents), which in GMSE are represented by individual table rows (`RESOURCES`, `AGENTS`, `OBSERVATION`) or layers of three-dimensional arrays (`COST`, `ACTION`). Individual-based models (IBMs) have been a useful approach in ecology for decades [@Uchmanski1996; @Grimm1999], providing both a pragmatic tool for the mechanistic modelling of complex populations and a powerful technique for theoretical investigation. A key advantage of the individual-based modelling approach is the discrete nature of individuals, which allows for detailed trait variation and complex interactions among individuals. In GMSE, some of the most important traits for resources include types, ages, demographic parameter values, locations, etc., and for agents (manager and users), traits include different types, utilities, budgets, etc. The traits that resources and managers have can potentially affect their interactions, and default GMSE submodels take advantage of this by simulating interactions explicitly on a landscape (see [SI7](SI7.pdf) for an introduction to GMSE default data structures).

Replicate simulations as a tool for model inference
================================================================================

Modelling complex interactions among discrete individuals mechanistically typically causes some degree of stochasticity in IBMs (in the code, this is caused by the sampling of random values, which determine probabilistically whether or not events such as birth or death occur for individuals), reflecting the uncertainty that is inherent to complex systems. We can see a simple example of this by calling `gmse_apply` under the same default conditions twice.

```{r}
rand_eg_1 <- gmse_apply();
print(rand_eg_1);
```

Although the second call to `gmse_apply` has identical initial conditions, because resource demographics (e.g., birth and death) and agent decision making (e.g., policy generation and user actions) is not deterministic, a slightly different result is obtained.

```{r}
rand_eg_2 <- gmse_apply();
print(rand_eg_2);
```

To make meaningful model inferences, it is often necessary to replicate simulations under the same initial conditions to understand the range of predicted outcomes for a particular set of parameter values. This can be computationally intense, but it can also lead to a more robust understanding of the range of dynamics that might be expected in a system. Additionally, when parameter values are unknown but believed to be important, replicate simulations can be applied across a range of values to understand how a particular parameter might affect system dynamics. Below, we show how to use the `gmse_replicates` function to simulate a simple example of a managed population that is hunted by users. This function calls `gmse` multiple times and aggregates the results from replicate simulations into a single table.

For a single simulation, the `gmse_table` function prints out key information from a `gmse` simulation result. The example provided in the GMSE documentation is below.

```{r}
gmse_sim  <- gmse(time_max = 10, plotting = FALSE);
sim_table <- gmse_table(gmse_sim = gmse_sim);
print(sim_table)
```

We can also only record the last time step in `gmse_table`. 

```{r}
sim_table_last <- gmse_table(gmse_sim = gmse_sim, all_time = FALSE);
print(sim_table_last)
```

The `gmse_replicates` function replicates multiple simulations under the same initial conditions, then returns a table showing the values of all simulations. This can be useful, for example, for testing how often a population is expected to go to extinction or carrying capacity under a given set of parameter values. First, we demonstrate the `gmse_replicates` function for simulations of 20 time steps; other parameter values are set to default values, except `plotting`, which we set to `FALSE` to avoid plotting each simulation result. We run 10 replicates below.

```{r, echo = FALSE, messages = FALSE, cache = FALSE, comment = FALSE, results = "hide"}
gmse_reps1 <- gmse_replicates(replicates = 10, time_max = 20, plotting = FALSE);
print(gmse_reps1);
```

```{r, eval = FALSE}
gmse_reps1 <- gmse_replicates(replicates = 10, time_max = 20, plotting = FALSE);
print(gmse_reps1);
```

```{r, echo = FALSE}
print(gmse_reps1);
```

Note from the results above that resources in all simulations persisted for 20 time steps, which means that extinction never occurred. We can also see that the population in all simulations never terminated at a density near the default carrying capacity of `res_death_K = 2000`, and was instead consistently near the target population size of `manage_target = 1000`. If we wish to define management success as having a population density near target levels after 20 time steps (perhaps interpreted as 20 years), then we might assess this population as successfully managed under the conditions of the simulation. We can then see what happens if managers only respond to changes in the social-ecological system with a change in policy once every two years, perhaps as a consequence of reduced funding for management or increasing demands for management attention elsewhere. This can be done by changing the default `manage_freq = 1` to `manage_freq = 2`.

```{r, echo = FALSE, messages = FALSE, cache = FALSE, comment = FALSE, results = "hide"}
gmse_reps2 <- gmse_replicates(replicates = 10, time_max = 20, plotting = FALSE,
                             manage_freq = 2);
print(gmse_reps2);
```

```{r, eval = FALSE}
gmse_reps2 <- gmse_replicates(replicates = 10, time_max = 20, plotting = FALSE, 
                             manage_freq = 2);
print(gmse_reps2);
```

```{r, echo = FALSE}
print(gmse_reps2);
```

Note that while extinction is still non-existent in these simulations, when populations are managed less frequently, they tend to be less close to the target size of 1000 after 20 generations. The median population size of `gmse_reps1` (management in every time step) is `r median(gmse_reps1[,2])`, with a maximum of `r max(gmse_reps1[,2])` and minimum of `r min(gmse_reps1[,2])`. While the median population size of `gmse_reps2` (management every two time steps) is `r median(gmse_reps2[,2])`, with a maximum of `r max(gmse_reps2[,2])` and minimum of `r min(gmse_reps2[,2])`. We can then see what happens when management occurs only once in every three time steps.

```{r, echo = FALSE, messages = FALSE, cache = FALSE, comment = FALSE, results = "hide"}
gmse_reps3 <- gmse_replicates(replicates = 10, time_max = 20, plotting = FALSE,
                             manage_freq = 3);
print(gmse_reps3);
```

```{r, eval = FALSE}
gmse_reps3 <- gmse_replicates(replicates = 10, time_max = 20, plotting = FALSE, 
                             manage_freq = 3);
print(gmse_reps3);
```

```{r, echo = FALSE}
print(gmse_reps3);
```

Given a management frequency of once every three time steps, the median population size of `gmse_reps3` (management in every time step) is `r median(gmse_reps3[,2])`, with a maximum of `r max(gmse_reps3[,2])` and minimum of `r min(gmse_reps3[,2])`. There are still no extinctions in the population, so below we change the management frequency to once every four time steps.

```{r, echo = FALSE, messages = FALSE, cache = FALSE, comment = FALSE, results = "hide"}
gmse_reps4 <- gmse_replicates(replicates = 10, time_max = 20, plotting = FALSE,
                             manage_freq = 4);
print(gmse_reps4);
```

```{r, eval = FALSE}
gmse_reps4 <- gmse_replicates(replicates = 10, time_max = 20, plotting = FALSE, 
                             manage_freq = 4);
print(gmse_reps4);
```

```{r, echo = FALSE}
print(gmse_reps4);
```

