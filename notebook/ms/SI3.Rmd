---
title: 'GMSE: an R package for generalised management strategy evaluation'
subtitle: Supporting Information 3
author: A. Bradley Duthie&#xb9;&#xb3;, Jeremy J. Cusack&#xb9;, Isabel L. Jones&#xb9;, Erlend B. Nilsen&#xb2;, Roc&#0237;o A. Pozo&#xb9;, O. Sarobidy Rakotonarivo&#xb9;, Bram Van Moorter&#xb2;, and Nils Bunnefeld&#xb9;
date: "[1] Biological and Environmental Sciences, University of Stirling, Stirling, UK
[2] Norwegian Institute for Nature Research, Trondheim, Norway [3] alexander.duthie@stir.ac.uk"
output:
  pdf_document:
    citation_package: natbib
    fig_caption: yes
  html_document: default
  word_document:
    fig_caption: yes
    reference_docx: docx_template.docx
header-includes:
linestretch: 1
bibliography: gmse.bib
biblio-style: apalike
link-citations: true
linkcolor: blue
---

```{r, echo = FALSE}
library(GMSE);
```

An example of management conflict using GMSE
================================================================================

Agents in GMSE (managers and users) are goal-oriented, and their behaviour is therefore driven to maximise a particular utility of interest such as a target density of resources (managers), or a suitable resource or landscape harvest size (users). This model feature allows GMSE to evaluate the actions of agents in the context of their individual objectives, and to therefore quantify the degree to which those objectives are or are not achieved. When the actions of one party clashes with the objectives of another party, the objectives of one might be expressed at the expense of the other, causing conservation conflict [@Redpath2013]. Currently, there is no standard way to measure conservation conflict in a social-ecological system, and previous modelling approaches have not meaningfully separated agent objectives from agent actions. We suggest that a starting point to developing a useful metric of conservation conflict is to quantify the deviation of an individual's actions from their objectives, the former of which is restricted by the actions of other individuals. Here we show how GMSE can be used to evaluate the amount of conflict in a simulated social-ecological system under different management options.

To demonstrate how GMSE can be used to understand conflict in social-ecological systems, we build upon the [example of resource management](https://www.biorxiv.org/content/biorxiv/early/2017/11/17/221432.full.pdf#page=5) in the main text. We consider a protected population of waterfowl that exploits agricultural land and is therefore a source of conservation conflict [e.g., @Fox2017a; @Mason2017; @Tulloch2017]. As in the main text example, the objective of managers is to keep waterfowl at a target abundance, while the objective of farmers is to maximise agricultural production on their landscape. Here we consider a more complex simulation to reflect a scenario that is likely to occur in a real social-ecological system. We parameterise our model using demographic information from the Taiga Bean Geese (*Anser fabalis fabalis*), a managed population that is hunted for sport in Fennoscandinavia [@Johnson2018]. Taiga Bean Geese can also cause agricultural damage, which can potentially lead to conflict between farmers and management objectives [@Johnson2018].

Using demographic parameters in simulations
--------------------------------------------------------------------------------

@Johnson2018 recently estimated key demographic parameters for the Taiga Bean Geese for the Central Management Unit that includes geese that breed in "Northern most Sweden, Northern Norway, Northern and Central Finland, and adjacent North-wester parts of Russia, wintering mostly in Southern Sweden and South-east Denmark" [@AEWA2016]. They estimated goose survival under ideal conditions to be ca 0.878; this can be interpreted in our model by setting mortality to `remove_pr = 1 - 0.878`. Similarly, @Johnson2018 estimated intrinsic population growth rate and carrying capacity to be 0.15 and 93870, respectively, so we set `lambda = 0.15` and `res_death_K = 93870`. The global abundance of Taiga Bean Geese in 2009 was ca 63000 [@Fox2010], and ca 35000 in the Central Management Unit [@AEWA2016], which we can take as a starting abundance for our simulations (`RESOURCE_ini = 35000`). And the International Single Species Action Plan has a target population size of ca 70000 in the Central Management Unit [@AEWA2016], which we can use as a management target (`manage_target = 70000`).

For simplicity, here we assess confict using only the `gmse` function to show how parameter values can be set to provide useful results. Our goal is not to provide a detailed case study of the Taiga Bean Geese, but rather to demonstrate how such a case study would be possible using the `gmse` function. Additionally, all of the analysis that follows would also be possibe using the more detailed, but also more flexible, `gmse_apply` function. Where available, we use estimated demographic parameter values from @Johnson2018 and @AEWA2016. Where GMSE parameter values are not available, we use reasonable values or GMSE defaults. To make model inferences for real case studies, we strongly recommend simulating across a range of parameter values when empirical estimates are unavailable, as social-ecological dynamics might be sensitive to these unknown values.

The code below calls `gmse` using the empirically derived parameters for Taiga Bean Geese described above. We also set `manager_budget = 100000` and `user_budget = 100000`. Further, we consider the case in of a region in which farmland makes up 60% of all land, with 40% of land being 'public' (`public_land = 0.4`; which might be intpreted as any land in which stakeholders are not, or cannot be, invested in goose presence), and divide the farmland amongst 80 individual farmers (`stakeholders = 80`; `land_ownership = TRUE`). Landscape size is set to default 100 by 100 cells, so each farmer effectively owns 75 cells, which might be interpreted as hectares of land (for instructions on how to more precisely control landscape ownership, see the advanced GMSE options using `gmse_apply`). Because we need both density-dependent (`res_death_K = 93870`) and density-independent (`remove_pr = 0.122`) sources of mortality, we set `res_death_type = 3`. We assume that a single goose decreases agricultural production on a cell by 1% per time step (`res_consume = 0.01`). We further assume that the population is well-monitored, with observers counting goose numbers on each cell of the landscape in every timestep (`observe_type = 3`) with the ability to observe two landscape cells in every direction (`agent_view = 2`). All other parameter values are set to GMSE defaults. 

Simulating goose management
--------------------------------------------------------------------------------

Below, we first allow only the culling of geese by users and plot the dynamics of the social-ecological from a single simulation. Next, we run the same simulation but allow users to scare geese from their landscape cells; we then use the model to make inferences regarding how scaring as a management option might affect goose population dynamics, agricultural production, and conservation conflict in the system.

```{r, echo = TRUE}
sim <- gmse(manager_budget = 100000, user_budget = 100000, res_death_K = 93870, 
            manage_target = 70000, RESOURCE_ini = 35000, plotting = FALSE, 
            stakeholders = 80, land_ownership = TRUE, public_land = 0.4, 
            scaring = FALSE, lambda = 0.150, remove_pr = 0.122, time_max = 20, 
            res_death_type = 3, res_consume = 0.01, res_birth_K = 200000, 
            observe_type = 3, agent_view = 1);
```

The results are plotted below.

```{r, eval = TRUE, fig.height = 8}
plot_gmse_results(res = sim$resource, obs = sim$observation, land = sim$land, 
                  agents = sim$agents, paras = sim$paras, ACTION = sim$action, 
                  COST = sim$cost);
```

Look at the conflict

```{r, eval = TRUE, fig.height = 7, fig.width = 6}
plot_gmse_effort(sim$agents, sim$paras, ACTION = sim$action, COST = sim$cost);
```

Now try scaring to see what happens.

```{r, echo = TRUE, fig.height = 8}
sim <- gmse(manager_budget = 10000, user_budget = 10000, res_death_K = 93870, 
            manage_target = 70000, RESOURCE_ini = 63000, plotting = FALSE, 
            stakeholders = 20, land_ownership = TRUE, land_dim_1 = 50, 
            land_dim_2 = 50, public_land = 0.4, scaring = TRUE, lambda = 0.275, 
            remove_pr = 0.122, time_max = 20, res_death_type = 3, ga_seedrep = 0, 
            ga_mingen = 100, res_consume = 0.02);
```

The results are plotted below.

References
--------------------------------------------------------------------------------

```{r, eval = TRUE, fig.height = 8}
plot_gmse_results(res = sim$resource, obs = sim$observation, land = sim$land, 
                  agents = sim$agents, paras = sim$paras, ACTION = sim$action, 
                  COST = sim$cost);
```

Look at the conflict

```{r, eval = TRUE, fig.height = 7, fig.width = 6}
plot_gmse_effort(sim$agents, sim$paras, ACTION = sim$action, COST = sim$cost);
```




